# 10. 测试策略

### 10.1 与现有测试集成

**现有测试框架**: pytest (Python) + Jest (TypeScript)
**测试组织**: 按功能模块组织，单元测试、集成测试、端到端测试分离
**覆盖率要求**: 单元测试覆盖率>80%，集成测试覆盖核心功能

### 10.2 新测试要求

#### 10.2.1 新组件单元测试
- **框架**: pytest + pytest-asyncio
- **位置**: backend/plugins/pm_agent/tests/ 和 tests/unit/
- **覆盖率目标**: >85%（高于现有标准）
- **与现有集成**: 使用相同的测试配置和fixture

**测试范围**:
- MilestoneManager: 里程碑创建、更新、状态管理
- RiskAssessmentEngine: 风险评估、计算、缓解计划
- EnhancedNotificationService: 通知调度、发送、错误处理

#### 10.2.2 集成测试
- **范围**: 新功能与现有系统的集成点
- **现有系统验证**: 确保新功能不影响现有任务管理、用户管理、飞书集成
- **新功能测试**: 验证里程碑、风险、通知功能的端到端流程

**关键集成测试场景**:
- 里程碑创建后自动生成相关任务
- 高风险项目自动触发通知
- 新API端点与现有认证系统集成
- 数据库迁移不影响现有数据

#### 10.2.3 回归测试
- **现有功能验证**: 自动化测试套件验证现有功能不受影响
- **自动化回归套件**: 集成到CI/CD管道，每次部署前执行
- **手动测试要求**: 关键业务流程的手动验证

**回归测试重点**:
- 现有任务管理功能完整性
- 飞书机器人消息发送功能
- 用户认证和权限管理
- 数据导出和报告生成
